pipeline {
  options {
    buildDiscarder logRotator(artifactDaysToKeepStr: '', artifactNumToKeepStr: '', daysToKeepStr: '7', numToKeepStr: '5')
  }
  agent {
    node {
      label 'jenkins-2'
    }
  }
  environment {
    NPM_TOKEN = credentials('moelab-npm-token')
  }
  stages {
    stage('Build es-home') {
      steps {
        withCredentials([file(credentialsId: 'npmrc-moesol', variable: 'NPMRC')]) {
          sh 'NOSUDO=1 ./es-home/deploy/build-prod-container.sh'
        }
      }
    }
  }
}
